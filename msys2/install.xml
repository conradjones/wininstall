<?xml version="1.0" encoding="UTF-8"?>
<package>
    <detect>
        <file>
            <path>C:\msys64\msys2.exe</path>
        </file>
        <file>
            <path>C:\msys64\usr\bin\bash.exe</path>
        </file>
    </detect>
    <steps>
        <download>http://repo.msys2.org/distrib/x86_64/msys2-x86_64-20190524.exe</download>
        <powershell>
            <scriptblock>
            $arguments = @("--script", "c:\.winstall\install\msys2\msys2.qs", "--platform", "minimal")
$process = Start-Process -FilePath c:\.winstall\install\msys2\msys2-x86_64-20190524.exe -ArgumentList $arguments -PassThru -Verbose

while (!($process.HasExited)) {
    $parent_process = Get-Process -Name "msys2-x86_64-20190524" -ErrorAction SilentlyContinue
    $child_process = Get-Process -Name "gpg-agent" -ErrorAction SilentlyContinue
    if (($child_process) -and !($parent_process)) { Stop-Process -Force -Verbose }
    $child_process = Get-Process -Name "dirmngr" -ErrorAction SilentlyContinue
    if (($child_process) -and !($parent_process)) { Stop-Process -Force -Verbose }
    Start-Sleep -Seconds 1
}
            </scriptblock>
        </powershell>
        <command>
            <commandline>c:\msys64\usr\bin\pacman.exe</commandline>
            <args>
                <arg>-Sy</arg>
                <arg>--noconfirm</arg>
                <arg>make</arg>
            </args>
        </command>
        <command>
            <commandline>c:\msys64\usr\bin\pacman.exe</commandline>
            <args>
                <arg>-Sy</arg>
                <arg>--noconfirm</arg>
                <arg>patch</arg>
            </args>
        </command>
        <command>
            <commandline>c:\msys64\usr\bin\pacman.exe</commandline>
            <args>
                <arg>-Sy</arg>
                <arg>--noconfirm</arg>
                <arg>mingw-w64-x86_64-make</arg>
            </args>
        </command>
        <path>C:\msys64\usr\bin</path>
        <path>C:\msys64\mingw64\bin</path>
    </steps>
</package>